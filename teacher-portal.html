<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Class - Teacher Portal</title>
    <link rel="icon" href="Apple vision canvas images/favicon.png" type="image/x-icon" />
    <!-- Google APIs -->
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255, 165, 0, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 165, 0, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.01) 0%, transparent 50%);
            min-height: 100vh;
            color: white;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.95) 100%),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 2px,
                    rgba(255, 165, 0, 0.01) 2px,
                    rgba(255, 165, 0, 0.01) 4px
                );
            pointer-events: none;
            z-index: -1;
        }

        /* Navigation Bar */
        .navbar {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 165, 0, 0.2);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.8);
            padding: 18px 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            color: #FFA500;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 165, 0, 0.6);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo::before {
            content: "üë©‚Äçüè´";
            font-size: 2rem;
        }

        .nav-menu {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-button {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 165, 0, 0.3);
            color: #FFA500;
            padding: 12px 24px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            cursor: pointer;
            font-size: 0.95rem;
        }

        .nav-button:hover {
            background: rgba(255, 165, 0, 0.1);
            border-color: #FFA500;
            color: #FFA500;
            box-shadow: 0 0 25px rgba(255, 165, 0, 0.4);
            transform: translateY(-3px);
        }

        /* Main Container */
        .main-container {
            margin-top: 80px;
            padding: 20px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255, 165, 0, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #FFA500;
            text-shadow: 0 0 25px rgba(255, 165, 0, 0.6);
            font-weight: 700;
        }

        .header h1::before {
            content: "üéì ";
            font-size: 3.5rem;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            color: #FFD700;
            font-weight: 500;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .dashboard-card {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            border: 1px solid rgba(255, 165, 0, 0.15);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 165, 0, 0.05), transparent);
            transition: left 0.5s ease;
        }

        .dashboard-card:hover::before {
            left: 100%;
        }

        .dashboard-card:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4), 0 0 30px rgba(255, 165, 0, 0.2);
            border-color: rgba(255, 165, 0, 0.4);
        }

        .card-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(0 0 10px rgba(255, 165, 0, 0.5));
        }

        .card-title {
            font-size: 1.6rem;
            margin-bottom: 12px;
            color: #FFA500;
            font-weight: 600;
            text-shadow: 0 0 15px rgba(255, 165, 0, 0.4);
        }

        .card-description {
            opacity: 0.8;
            line-height: 1.6;
            color: #C0C0C0;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 165, 0, 0.2);
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            transform: scale(0.7);
            transition: all 0.3s ease;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        /* Custom Scrollbar for Modal Content */
        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: rgba(255, 165, 0, 0.6);
            border-radius: 10px;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 165, 0, 0.8);
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 165, 0, 0.2);
        }

        .modal-title {
            font-size: 2rem;
            color: #FFA500;
            text-shadow: 0 0 15px rgba(255, 165, 0, 0.5);
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            color: #ff6b6b;
            transform: scale(1.2);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: white;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 15px;
            border: 1px solid rgba(255, 165, 0, 0.2);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: #FFA500;
            box-shadow: 0 0 20px rgba(255, 165, 0, 0.4);
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: rgba(192, 192, 192, 0.6);
        }

        .file-upload {
            border: 2px dashed rgba(255, 165, 0, 0.3);
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.5);
        }

        .file-upload:hover {
            border-color: #FFA500;
            background: rgba(255, 165, 0, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #FFA500, #FF8C00);
            color: #000;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 165, 0, 0.4);
            background: linear-gradient(45deg, #FF8C00, #FFA500);
        }

        .btn-secondary {
            background: rgba(0, 0, 0, 0.8);
            color: #FFA500;
            border: 1px solid rgba(255, 165, 0, 0.5);
            font-weight: 500;
        }

        .btn-secondary:hover {
            background: rgba(255, 165, 0, 0.1);
            border-color: #FFA500;
            color: #FFD700;
        }

        /* Student List */
        .student-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 165, 0, 0.2);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.5);
        }

        /* Custom Scrollbar for Student List */
        .student-list::-webkit-scrollbar {
            width: 6px;
        }

        .student-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .student-list::-webkit-scrollbar-thumb {
            background: rgba(255, 165, 0, 0.6);
            border-radius: 10px;
        }

        .student-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 165, 0, 0.8);
        }

        .student-item {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 165, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .student-item:last-child {
            border-bottom: none;
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .student-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #FFA500;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #000;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .quick-actions .btn {
            flex: 1;
            min-width: 200px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 165, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(255, 165, 0, 0.1), transparent);
            animation: rotate 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 165, 0, 0.2);
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .stat-number {
            font-size: 2.8rem;
            font-weight: bold;
            color: #FFA500;
            margin-bottom: 8px;
            text-shadow: 0 0 15px rgba(255, 165, 0, 0.5);
            position: relative;
            z-index: 1;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 1rem;
            color: #C0C0C0;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* Custom Scrollbar for Questions Container */
        #questionsContainer::-webkit-scrollbar {
            width: 6px;
        }

        #questionsContainer::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        #questionsContainer::-webkit-scrollbar-thumb {
            background: rgba(255, 165, 0, 0.6);
            border-radius: 10px;
        }

        #questionsContainer::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 165, 0, 0.8);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-menu {
                gap: 10px;
            }
            
            .nav-button {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .quick-actions .btn {
                min-width: auto;
            }
            
            .modal-content {
                width: 95%;
                margin: 2% auto;
                max-height: 95vh;
                padding: 15px;
            }

            .form-group {
                margin-bottom: 15px;
            }

            .content h2 {
                font-size: 1.5rem;
            }

            #studentsList {
                max-height: 300px;
            }

            #questionsContainer {
                max-height: 300px;
            }
        }

        /* Animation for cards */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dashboard-card {
            animation: slideInUp 0.6s ease-out;
        }

        .dashboard-card:nth-child(2) {
            animation-delay: 0.1s;
        }

        .dashboard-card:nth-child(3) {
            animation-delay: 0.2s;
        }

        .dashboard-card:nth-child(4) {
            animation-delay: 0.3s;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">üë©‚Äçüè´ VR CLASS TEACHER</div>
            <div class="nav-menu">
                <a href="index.html" class="nav-button">Home</a>
                <a href="quickmeet-master/public/index.html" class="nav-button">üé• QuickMeet</a>
                <a href="contact.html" class="nav-button">Contact</a>
                <button class="nav-button" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Header -->
        <div class="header">
            <h1>Professional Teacher Dashboard</h1>
            <p id="teacherWelcome">Empower your students with cutting-edge VR education and comprehensive class management</p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalStudents">0</div>
                <div class="stat-label">Total Students</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalAssignments">0</div>
                <div class="stat-label">Assignments</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalQuizzes">0</div>
                <div class="stat-label">Quizzes</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingRequests">0</div>
                <div class="stat-label">Doubt Sessions</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="classroomCourses">0</div>
                <div class="stat-label">Classroom Courses</div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Upload Assignment Card -->
            <div class="dashboard-card" onclick="openModal('assignmentModal')">
                <span class="card-icon">üìö</span>
                <h3 class="card-title">Upload Assignment</h3>
                <p class="card-description">Create and upload new assignments for your students with due dates and instructions.</p>
            </div>

            <!-- Create Quiz Card -->
            <div class="dashboard-card" onclick="openModal('quizModal')">
                <span class="card-icon">üìù</span>
                <h3 class="card-title">Create Quiz</h3>
                <p class="card-description">Design interactive quizzes with multiple choice questions and automatic grading.</p>
            </div>

            <!-- Manage Students Card -->
            <div class="dashboard-card" onclick="openModal('studentsModal')">
                <span class="card-icon">üë•</span>
                <h3 class="card-title">Manage Students</h3>
                <p class="card-description">View student progress, grades, and manage class enrollment.</p>
            </div>

            <!-- Doubt Sessions Card -->
            <div class="dashboard-card" onclick="openDoubtSessions()">
                <span class="card-icon">üí¨</span>
                <h3 class="card-title">Solve Doubts</h3>
                <p class="card-description">Start video calls with QuickMeet to solve student doubts and provide guidance.</p>
            </div>

            <!-- Google Classroom Integration Card -->
            <div class="dashboard-card" onclick="openModal('classroomModal')">
                <span class="card-icon">üè´</span>
                <h3 class="card-title">Google Classroom</h3>
                <p class="card-description">Sync with Google Classroom to manage courses, assignments, and student submissions.</p>
            </div>

            <!-- Student Analytics Card -->
            <div class="dashboard-card" onclick="openModal('analyticsModal')">
                <span class="card-icon">üìä</span>
                <h3 class="card-title">Student Analytics</h3>
                <p class="card-description">View detailed analytics and performance insights for all your students.</p>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="btn btn-primary" onclick="openModal('assignmentModal')">üìö New Assignment</button>
            <button class="btn btn-primary" onclick="openModal('quizModal')">üìù New Quiz</button>
            <button class="btn btn-primary" onclick="openModal('classroomModal')">üè´ Google Classroom</button>
            <button class="btn btn-secondary" onclick="openDoubtSessions()">üé• Start Doubt Session</button>
            <button class="btn btn-secondary" onclick="viewReports()">üìä View Reports</button>
        </div>
    </div>

    <!-- Assignment Modal -->
    <div class="modal" id="assignmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìö Upload Assignment</h2>
                <button class="close-btn" onclick="closeModal('assignmentModal')">&times;</button>
            </div>
            <form id="assignmentForm">
                <div class="form-group">
                    <label for="assignmentTitle">Assignment Title</label>
                    <input type="text" id="assignmentTitle" class="form-input" placeholder="Enter assignment title" required>
                </div>
                
                <div class="form-group">
                    <label for="assignmentSubject">Subject</label>
                    <select id="assignmentSubject" class="form-select" required>
                        <option value="">Select Subject</option>
                        <option value="mathematics">Mathematics</option>
                        <option value="science">Science</option>
                        <option value="physics">Physics</option>
                        <option value="chemistry">Chemistry</option>
                        <option value="biology">Biology</option>
                        <option value="english">English</option>
                        <option value="history">History</option>
                        <option value="geography">Geography</option>
                        <option value="computer-science">Computer Science</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="assignmentDescription">Description</label>
                    <textarea id="assignmentDescription" class="form-textarea" placeholder="Describe the assignment, instructions, and requirements" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="assignmentDueDate">Due Date</label>
                    <input type="datetime-local" id="assignmentDueDate" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="assignmentMaxMarks">Maximum Marks</label>
                    <input type="number" id="assignmentMaxMarks" class="form-input" placeholder="Enter maximum marks" min="1" required>
                </div>
                
                <div class="form-group">
                    <label>Assignment File (Optional)</label>
                    <div class="file-upload" onclick="document.getElementById('assignmentFile').click()">
                        <input type="file" id="assignmentFile" accept=".pdf,.doc,.docx,.txt,.jpg,.png">
                        <div>üìÅ Click to upload file or drag and drop</div>
                        <small>PDF, DOC, DOCX, TXT, JPG, PNG (Max 10MB)</small>
                    </div>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Create Assignment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div class="modal" id="quizModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìù Create Quiz</h2>
                <button class="close-btn" onclick="closeModal('quizModal')">&times;</button>
            </div>
            <form id="quizForm">
                <div class="form-group">
                    <label for="quizTitle">Quiz Title</label>
                    <input type="text" id="quizTitle" class="form-input" placeholder="Enter quiz title" required>
                </div>
                
                <div class="form-group">
                    <label for="quizSubject">Subject</label>
                    <select id="quizSubject" class="form-select" required>
                        <option value="">Select Subject</option>
                        <option value="mathematics">Mathematics</option>
                        <option value="science">Science</option>
                        <option value="physics">Physics</option>
                        <option value="chemistry">Chemistry</option>
                        <option value="biology">Biology</option>
                        <option value="english">English</option>
                        <option value="history">History</option>
                        <option value="geography">Geography</option>
                        <option value="computer-science">Computer Science</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quizDuration">Duration (minutes)</label>
                    <input type="number" id="quizDuration" class="form-input" placeholder="Enter duration in minutes" min="1" required>
                </div>
                
                <div class="form-group">
                    <label for="quizDueDate">Due Date</label>
                    <input type="datetime-local" id="quizDueDate" class="form-input" required>
                </div>

                <div class="form-group">
                    <label>Quiz Questions</label>
                    <div id="questionsContainer" style="max-height: 400px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; padding: 15px; background: rgba(255,255,255,0.05);">
                        <div class="question-item" data-question="1">
                            <div class="form-group">
                                <label>Question 1</label>
                                <textarea class="form-textarea question-text" placeholder="Enter your question" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Options</label>
                                <input type="text" class="form-input option-input" placeholder="Option A" required>
                                <input type="text" class="form-input option-input" placeholder="Option B" required style="margin-top: 5px;">
                                <input type="text" class="form-input option-input" placeholder="Option C" required style="margin-top: 5px;">
                                <input type="text" class="form-input option-input" placeholder="Option D" required style="margin-top: 5px;">
                            </div>
                            <div class="form-group">
                                <label>Correct Answer</label>
                                <select class="form-select correct-answer" required>
                                    <option value="">Select correct option</option>
                                    <option value="A">Option A</option>
                                    <option value="B">Option B</option>
                                    <option value="C">Option C</option>
                                    <option value="D">Option D</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addQuestion()" style="margin-top: 10px;">+ Add Question</button>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Create Quiz</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Students Modal -->
    <div class="modal" id="studentsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üë• Manage Students</h2>
                <button class="close-btn" onclick="closeModal('studentsModal')">&times;</button>
            </div>
            <div class="student-list" id="studentsList">
                <!-- Student list will be populated here -->
            </div>
        </div>
    </div>

    <!-- Google Classroom Modal -->
    <div class="modal" id="classroomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üè´ Google Classroom Integration</h2>
                <button class="close-btn" onclick="closeModal('classroomModal')">&times;</button>
            </div>
            
            <div id="classroomAuth" style="display: block;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">üè´</div>
                    <h3 style="color: #FFA500; margin-bottom: 15px;">Connect to Google Classroom</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 30px;">
                        Sync your VR Class with Google Classroom to manage courses, assignments, and student progress seamlessly.
                    </p>
                    <button id="authorizeBtn" class="btn btn-primary" onclick="authorizeGoogleClassroom()" style="width: 100%; font-size: 1.1rem; padding: 15px;">
                        üîê Authorize Google Classroom Access
                    </button>
                </div>
            </div>

            <div id="classroomDashboard" style="display: none;">
                <div class="classroom-tabs" style="display: flex; margin-bottom: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; overflow: hidden;">
                    <button class="classroom-tab active" onclick="switchClassroomTab('courses')" data-tab="courses" style="flex: 1; padding: 12px; background: transparent; border: none; color: white; cursor: pointer; transition: all 0.3s ease;">
                        üìö Courses
                    </button>
                    <button class="classroom-tab" onclick="switchClassroomTab('assignments')" data-tab="assignments" style="flex: 1; padding: 12px; background: transparent; border: none; color: white; cursor: pointer; transition: all 0.3s ease;">
                        üìù Assignments
                    </button>
                    <button class="classroom-tab" onclick="switchClassroomTab('sync')" data-tab="sync" style="flex: 1; padding: 12px; background: transparent; border: none; color: white; cursor: pointer; transition: all 0.3s ease;">
                        üîÑ Sync
                    </button>
                </div>

                <div id="coursesTab" class="classroom-tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #FFA500;">Your Google Classroom Courses</h3>
                        <button class="btn btn-secondary" onclick="refreshCourses()" style="padding: 8px 16px; font-size: 0.9rem;">
                            üîÑ Refresh
                        </button>
                    </div>
                    <div id="coursesList" style="max-height: 300px; overflow-y: auto;">
                        <!-- Courses will be loaded here -->
                    </div>
                </div>

                <div id="assignmentsTab" class="classroom-tab-content" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #FFA500;">Assignments & Student Work</h3>
                        <button class="btn btn-secondary" onclick="refreshAssignments()" style="padding: 8px 16px; font-size: 0.9rem;">
                            üîÑ Refresh
                        </button>
                    </div>
                    <div id="assignmentsList" style="max-height: 300px; overflow-y: auto;">
                        <!-- Assignments will be loaded here -->
                    </div>
                </div>

                <div id="syncTab" class="classroom-tab-content" style="display: none;">
                    <h3 style="color: #FFA500; margin-bottom: 20px;">Sync VR Classes with Google Classroom</h3>
                    <div class="form-group">
                        <label for="syncCourse">Select Google Classroom Course</label>
                        <select id="syncCourse" class="form-select">
                            <option value="">Choose a course to sync...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Sync Options</label>
                        <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="syncAssignments" checked style="transform: scale(1.2);">
                                <span>Sync Assignments from Google Classroom</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="syncStudents" checked style="transform: scale(1.2);">
                                <span>Sync Student Roster</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="syncGrades" style="transform: scale(1.2);">
                                <span>Sync Grades to Google Classroom</span>
                            </label>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="startSync()" style="width: 100%; margin-top: 20px;">
                        üîÑ Start Synchronization
                    </button>
                </div>

                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.2);">
                    <button class="btn btn-secondary" onclick="disconnectGoogleClassroom()" style="background: rgba(255, 107, 107, 0.2); border-color: #ff6b6b; color: #ff6b6b;">
                        üîå Disconnect Google Classroom
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal" id="analyticsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìä Student Analytics</h2>
                <button class="close-btn" onclick="closeModal('analyticsModal')">&times;</button>
            </div>
            
            <div class="analytics-dashboard">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="stat-card">
                        <div class="stat-number" id="avgScore">85%</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completionRate">92%</div>
                        <div class="stat-label">Completion Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeStudents">24</div>
                        <div class="stat-label">Active Students</div>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h3 style="color: #FFA500; margin-bottom: 15px;">Performance Trends</h3>
                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 20px; text-align: center;">
                        <p style="color: rgba(255, 255, 255, 0.8);">üìà Performance chart will be displayed here</p>
                        <p style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.6);">Integration with analytics libraries coming soon</p>
                    </div>
                </div>

                <div>
                    <h3 style="color: #FFA500; margin-bottom: 15px;">Top Performing Students</h3>
                    <div id="topStudents" style="background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 20px;">
                        <!-- Top students will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTeacher = null;
        let questionCount = 1;

        // Initialize teacher portal
        window.addEventListener('load', function() {
            currentTeacher = JSON.parse(localStorage.getItem('vrClassCurrentUser') || 'null');
            
            if (!currentTeacher || currentTeacher.userType !== 'teacher') {
                alert('Access denied. Teacher login required.');
                window.location.href = 'index.html';
                return;
            }
            
            document.getElementById('teacherWelcome').textContent = 
                `Welcome back, Professor ${currentTeacher.name}! Transform education through ${currentTeacher.subject} in Virtual Reality`;
            
            loadStats();
            loadStudents();
        });

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // Assignment form submission
        document.getElementById('assignmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const assignment = {
                id: Date.now(),
                title: document.getElementById('assignmentTitle').value,
                subject: document.getElementById('assignmentSubject').value,
                description: document.getElementById('assignmentDescription').value,
                dueDate: document.getElementById('assignmentDueDate').value,
                maxMarks: document.getElementById('assignmentMaxMarks').value,
                teacherId: currentTeacher.id,
                teacherName: currentTeacher.name,
                createdAt: new Date().toISOString(),
                submissions: [],
                isActive: true,
                publishedToStudents: true
            };
            
            // Save assignment to localStorage (shared with students)
            const assignments = JSON.parse(localStorage.getItem('vrClassAssignments') || '[]');
            assignments.push(assignment);
            localStorage.setItem('vrClassAssignments', JSON.stringify(assignments));
            
            // Notify students about new assignment
            notifyStudentsNewAssignment(assignment);
            
            alert('Assignment created and published to students successfully! üìö');
            closeModal('assignmentModal');
            document.getElementById('assignmentForm').reset();
            loadStats();
            
            // Update student notifications
            addStudentNotification({
                type: 'assignment',
                title: `New Assignment: ${assignment.title}`,
                message: `${currentTeacher.name} has assigned "${assignment.title}" in ${assignment.subject}`,
                assignmentId: assignment.id,
                timestamp: new Date().toISOString()
            });
        });

        // Quiz form submission
        document.getElementById('quizForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const questions = [];
            const questionItems = document.querySelectorAll('.question-item');
            
            questionItems.forEach((item, index) => {
                const questionText = item.querySelector('.question-text').value;
                const options = Array.from(item.querySelectorAll('.option-input')).map(input => input.value);
                const correctAnswer = item.querySelector('.correct-answer').value;
                
                questions.push({
                    id: index + 1,
                    question: questionText,
                    options: options,
                    correctAnswer: correctAnswer
                });
            });
            
            const quiz = {
                id: Date.now(),
                title: document.getElementById('quizTitle').value,
                subject: document.getElementById('quizSubject').value,
                duration: document.getElementById('quizDuration').value,
                dueDate: document.getElementById('quizDueDate').value,
                questions: questions,
                teacherId: currentTeacher.id,
                teacherName: currentTeacher.name,
                createdAt: new Date().toISOString(),
                attempts: [],
                isActive: true,
                publishedToStudents: true
            };
            
            // Save quiz to localStorage (shared with students)
            const quizzes = JSON.parse(localStorage.getItem('vrClassQuizzes') || '[]');
            quizzes.push(quiz);
            localStorage.setItem('vrClassQuizzes', JSON.stringify(quizzes));
            
            // Notify students about new quiz
            notifyStudentsNewQuiz(quiz);
            
            alert('Quiz created and published to students successfully! üìù');
            closeModal('quizModal');
            document.getElementById('quizForm').reset();
            resetQuestions();
            loadStats();
            
            // Update student notifications
            addStudentNotification({
                type: 'quiz',
                title: `New Quiz: ${quiz.title}`,
                message: `${currentTeacher.name} has created a new quiz "${quiz.title}" in ${quiz.subject}`,
                quizId: quiz.id,
                timestamp: new Date().toISOString()
            });
        });

        // Add new question to quiz
        function addQuestion() {
            questionCount++;
            const container = document.getElementById('questionsContainer');
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-item';
            questionDiv.setAttribute('data-question', questionCount);
            questionDiv.innerHTML = `
                <div class="form-group">
                    <label>Question ${questionCount}</label>
                    <textarea class="form-textarea question-text" placeholder="Enter your question" required></textarea>
                </div>
                <div class="form-group">
                    <label>Options</label>
                    <input type="text" class="form-input option-input" placeholder="Option A" required>
                    <input type="text" class="form-input option-input" placeholder="Option B" required style="margin-top: 5px;">
                    <input type="text" class="form-input option-input" placeholder="Option C" required style="margin-top: 5px;">
                    <input type="text" class="form-input option-input" placeholder="Option D" required style="margin-top: 5px;">
                </div>
                <div class="form-group">
                    <label>Correct Answer</label>
                    <select class="form-select correct-answer" required>
                        <option value="">Select correct option</option>
                        <option value="A">Option A</option>
                        <option value="B">Option B</option>
                        <option value="C">Option C</option>
                        <option value="D">Option D</option>
                    </select>
                </div>
                <button type="button" class="btn btn-secondary" onclick="removeQuestion(${questionCount})" style="margin-top: 10px; background: #ff6b6b;">Remove Question</button>
                <hr style="margin: 20px 0; border: 1px solid rgba(255,255,255,0.2);">
            `;
            
            container.appendChild(questionDiv);
        }

        function removeQuestion(questionNum) {
            const questionItem = document.querySelector(`[data-question="${questionNum}"]`);
            if (questionItem && questionCount > 1) {
                questionItem.remove();
                questionCount--;
            }
        }

        function resetQuestions() {
            questionCount = 1;
            document.getElementById('questionsContainer').innerHTML = `
                <div class="question-item" data-question="1">
                    <div class="form-group">
                        <label>Question 1</label>
                        <textarea class="form-textarea question-text" placeholder="Enter your question" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Options</label>
                        <input type="text" class="form-input option-input" placeholder="Option A" required>
                        <input type="text" class="form-input option-input" placeholder="Option B" required style="margin-top: 5px;">
                        <input type="text" class="form-input option-input" placeholder="Option C" required style="margin-top: 5px;">
                        <input type="text" class="form-input option-input" placeholder="Option D" required style="margin-top: 5px;">
                    </div>
                    <div class="form-group">
                        <label>Correct Answer</label>
                        <select class="form-select correct-answer" required>
                            <option value="">Select correct option</option>
                            <option value="A">Option A</option>
                            <option value="B">Option B</option>
                            <option value="C">Option C</option>
                            <option value="D">Option D</option>
                        </select>
                    </div>
                </div>
            `;
        }

        // Load statistics
        function loadStats() {
            const users = JSON.parse(localStorage.getItem('vrClassUsers') || '[]');
            const assignments = JSON.parse(localStorage.getItem('vrClassAssignments') || '[]');
            const quizzes = JSON.parse(localStorage.getItem('vrClassQuizzes') || '[]');
            
            const students = users.filter(user => user.userType === 'student');
            const teacherAssignments = assignments.filter(assignment => assignment.teacherId === currentTeacher.id);
            const teacherQuizzes = quizzes.filter(quiz => quiz.teacherId === currentTeacher.id);
            
            // Update classroom courses count based on authorization status
            const classroomCoursesCount = isGoogleClassroomAuthorized ? googleClassroomCourses.length : 0;
            
            document.getElementById('totalStudents').textContent = students.length;
            document.getElementById('totalAssignments').textContent = teacherAssignments.length;
            document.getElementById('totalQuizzes').textContent = teacherQuizzes.length;
            document.getElementById('pendingRequests').textContent = Math.floor(Math.random() * 5); // Mock data
            document.getElementById('classroomCourses').textContent = classroomCoursesCount;
        }

        // Load students
        function loadStudents() {
            const users = JSON.parse(localStorage.getItem('vrClassUsers') || '[]');
            const students = users.filter(user => user.userType === 'student');
            
            const studentsList = document.getElementById('studentsList');
            studentsList.innerHTML = '';
            
            if (students.length === 0) {
                studentsList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">No students enrolled yet</div>';
                return;
            }
            
            students.forEach(student => {
                const studentDiv = document.createElement('div');
                studentDiv.className = 'student-item';
                studentDiv.innerHTML = `
                    <div class="student-info">
                        <div class="student-avatar">${student.name.charAt(0).toUpperCase()}</div>
                        <div>
                            <div style="font-weight: bold;">${student.name}</div>
                            <div style="opacity: 0.7; font-size: 0.9rem;">${student.email} ‚Ä¢ Grade ${student.grade}</div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="startDoubtSession('${student.id}', '${student.name}')" style="padding: 5px 15px; font-size: 0.8rem;">
                        üé• Call
                    </button>
                `;
                studentsList.appendChild(studentDiv);
            });
        }

        // Doubt session functions
        function openDoubtSessions() {
            window.open('quickmeet-master/public/index.html', '_blank');
        }

        function startDoubtSession(studentId, studentName) {
            if (confirm(`Start a video call with ${studentName}?`)) {
                window.open('quickmeet-master/public/index.html', '_blank');
            }
        }

        function viewReports() {
            alert('Reports feature coming soon! üìä\n\nThis will show:\n‚Ä¢ Student performance analytics\n‚Ä¢ Assignment submission rates\n‚Ä¢ Quiz scores and analysis\n‚Ä¢ Attendance tracking');
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('vrClassCurrentUser');
                window.location.href = 'index.html';
            }
        }

        // File upload handling
        document.getElementById('assignmentFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                if (file.size > 10 * 1024 * 1024) { // 10MB limit
                    alert('File size must be less than 10MB');
                    e.target.value = '';
                    return;
                }
                
                const uploadDiv = document.querySelector('.file-upload');
                uploadDiv.innerHTML = `
                    <div>‚úÖ ${file.name}</div>
                    <small>File selected successfully</small>
                `;
            }
        });

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal(this.id);
                }
            });
        });

        // Google Classroom Integration Functions
        let gapi = null;
        let isGoogleClassroomAuthorized = false;
        let googleClassroomCourses = [];

        // Google API Configuration
        const GOOGLE_CLIENT_ID = 'your-google-client-id'; // Replace with actual client ID
        const GOOGLE_API_KEY = 'your-google-api-key'; // Replace with actual API key
        const DISCOVERY_DOC = 'https://classroom.googleapis.com/$discovery/rest?version=v1';
        const SCOPES = 'https://www.googleapis.com/auth/classroom.courses.readonly https://www.googleapis.com/auth/classroom.coursework.students https://www.googleapis.com/auth/classroom.rosters.readonly';

        // Initialize Google API
        function initializeGoogleAPI() {
            // For demo purposes, we'll simulate the API
            // In production, you would load the real Google API
            console.log('Google Classroom API initialized (demo mode)');
            
            // Check if user was previously authorized
            const wasAuthorized = localStorage.getItem('googleClassroomAuthorized');
            if (wasAuthorized === 'true') {
                isGoogleClassroomAuthorized = true;
                showClassroomDashboard();
                loadDemoCourses();
            }
        }

        function authorizeGoogleClassroom() {
            // Simulate authorization process
            showAuthorizationProgress();
            
            setTimeout(() => {
                isGoogleClassroomAuthorized = true;
                localStorage.setItem('googleClassroomAuthorized', 'true');
                showClassroomDashboard();
                loadDemoCourses();
                showSuccessMessage('Successfully connected to Google Classroom! üéâ');
            }, 2000);
        }

        function showAuthorizationProgress() {
            const authDiv = document.getElementById('classroomAuth');
            const btn = document.getElementById('authorizeBtn');
            
            btn.innerHTML = 'üîÑ Connecting to Google...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = '‚úÖ Authorization Complete!';
            }, 1500);
        }

        function showClassroomDashboard() {
            document.getElementById('classroomAuth').style.display = 'none';
            document.getElementById('classroomDashboard').style.display = 'block';
        }

        function loadDemoCourses() {
            // Demo courses data
            googleClassroomCourses = [
                {
                    id: 'course1',
                    name: 'Advanced Mathematics - Grade 12',
                    section: 'Section A',
                    enrollmentCode: 'MATH12A',
                    studentCount: 28,
                    alternateLink: '#'
                },
                {
                    id: 'course2',
                    name: 'Physics Fundamentals - Grade 11',
                    section: 'Section B',
                    enrollmentCode: 'PHYS11B',
                    studentCount: 25,
                    alternateLink: '#'
                },
                {
                    id: 'course3',
                    name: 'Chemistry Lab - Grade 10',
                    section: 'Section C',
                    enrollmentCode: 'CHEM10C',
                    studentCount: 22,
                    alternateLink: '#'
                }
            ];

            displayCourses();
            populateSyncCourseDropdown();
            loadStats(); // Update stats to reflect classroom courses count
        }

        function displayCourses() {
            const coursesList = document.getElementById('coursesList');
            coursesList.innerHTML = '';

            if (googleClassroomCourses.length === 0) {
                coursesList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">No courses found</div>';
                return;
            }

            googleClassroomCourses.forEach(course => {
                const courseDiv = document.createElement('div');
                courseDiv.style.cssText = `
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 15px;
                    margin-bottom: 10px;
                    border-left: 4px solid #FFA500;
                `;
                
                courseDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 style="color: #FFA500; margin-bottom: 5px;">${course.name}</h4>
                            <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 5px;">${course.section}</p>
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.8rem;">
                                üë• ${course.studentCount} students ‚Ä¢ Code: ${course.enrollmentCode}
                            </p>
                        </div>
                        <div>
                            <button class="btn btn-secondary" onclick="syncCourse('${course.id}')" style="padding: 8px 16px; font-size: 0.8rem; margin-right: 5px;">
                                üîÑ Sync
                            </button>
                            <button class="btn btn-primary" onclick="openCourseInClassroom('${course.alternateLink}')" style="padding: 8px 16px; font-size: 0.8rem;">
                                üîó Open
                            </button>
                        </div>
                    </div>
                `;
                
                coursesList.appendChild(courseDiv);
            });
        }

        function populateSyncCourseDropdown() {
            const syncCourseSelect = document.getElementById('syncCourse');
            syncCourseSelect.innerHTML = '<option value="">Choose a course to sync...</option>';
            
            googleClassroomCourses.forEach(course => {
                const option = document.createElement('option');
                option.value = course.id;
                option.textContent = course.name;
                syncCourseSelect.appendChild(option);
            });
        }

        function switchClassroomTab(tabName) {
            // Remove active class from all tabs
            document.querySelectorAll('.classroom-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.background = 'transparent';
            });
            
            // Hide all tab contents
            document.querySelectorAll('.classroom-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Tab').style.display = 'block';
            
            // Add active class to selected tab
            const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
            activeTab.classList.add('active');
            activeTab.style.background = '#FFA500';
            activeTab.style.color = '#000';

            // Load content based on tab
            if (tabName === 'assignments') {
                loadDemoAssignments();
            }
        }

        function loadDemoAssignments() {
            const assignmentsList = document.getElementById('assignmentsList');
            const demoAssignments = [
                {
                    id: 'assign1',
                    title: 'Quadratic Equations Practice',
                    course: 'Advanced Mathematics',
                    dueDate: '2025-07-30',
                    submissions: 24,
                    totalStudents: 28
                },
                {
                    id: 'assign2',
                    title: 'Newton\'s Laws Lab Report',
                    course: 'Physics Fundamentals',
                    dueDate: '2025-08-05',
                    submissions: 18,
                    totalStudents: 25
                },
                {
                    id: 'assign3',
                    title: 'Chemical Bonding Quiz',
                    course: 'Chemistry Lab',
                    dueDate: '2025-07-28',
                    submissions: 22,
                    totalStudents: 22
                }
            ];

            assignmentsList.innerHTML = '';
            
            demoAssignments.forEach(assignment => {
                const submissionRate = Math.round((assignment.submissions / assignment.totalStudents) * 100);
                const assignDiv = document.createElement('div');
                assignDiv.style.cssText = `
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                    padding: 15px;
                    margin-bottom: 10px;
                    border-left: 4px solid ${submissionRate >= 80 ? '#4CAF50' : submissionRate >= 60 ? '#FFA500' : '#ff6b6b'};
                `;
                
                assignDiv.innerHTML = `
                    <div>
                        <h4 style="color: #FFA500; margin-bottom: 5px;">${assignment.title}</h4>
                        <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; margin-bottom: 5px;">${assignment.course}</p>
                        <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.8rem; margin-bottom: 10px;">
                            üìÖ Due: ${new Date(assignment.dueDate).toLocaleDateString()}
                        </p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: ${submissionRate >= 80 ? '#4CAF50' : submissionRate >= 60 ? '#FFA500' : '#ff6b6b'};">
                                üìä ${assignment.submissions}/${assignment.totalStudents} submitted (${submissionRate}%)
                            </span>
                            <button class="btn btn-secondary" onclick="viewAssignmentDetails('${assignment.id}')" style="padding: 5px 12px; font-size: 0.8rem;">
                                üëÄ View Details
                            </button>
                        </div>
                    </div>
                `;
                
                assignmentsList.appendChild(assignDiv);
            });
        }

        function refreshCourses() {
            showLoadingMessage('coursesList', 'Refreshing courses...');
            setTimeout(() => {
                loadDemoCourses();
                showSuccessMessage('Courses refreshed successfully! üîÑ');
            }, 1000);
        }

        function refreshAssignments() {
            showLoadingMessage('assignmentsList', 'Refreshing assignments...');
            setTimeout(() => {
                loadDemoAssignments();
                showSuccessMessage('Assignments refreshed successfully! üîÑ');
            }, 1000);
        }

        function showLoadingMessage(elementId, message) {
            document.getElementById(elementId).innerHTML = `
                <div style="text-align: center; padding: 20px; opacity: 0.7;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">‚è≥</div>
                    <div>${message}</div>
                </div>
            `;
        }

        function syncCourse(courseId) {
            const course = googleClassroomCourses.find(c => c.id === courseId);
            if (course) {
                showSuccessMessage(`Syncing ${course.name}... üîÑ`);
                // Simulate sync process
                setTimeout(() => {
                    showSuccessMessage(`${course.name} synced successfully! ‚úÖ`);
                }, 2000);
            }
        }

        function openCourseInClassroom(link) {
            // In a real implementation, this would open the actual Google Classroom course
            showSuccessMessage('Opening course in Google Classroom... üîó');
        }

        function viewAssignmentDetails(assignmentId) {
            showSuccessMessage('Opening assignment details... üìù');
        }

        function startSync() {
            const selectedCourse = document.getElementById('syncCourse').value;
            if (!selectedCourse) {
                alert('Please select a course to sync.');
                return;
            }

            const course = googleClassroomCourses.find(c => c.id === selectedCourse);
            const syncAssignments = document.getElementById('syncAssignments').checked;
            const syncStudents = document.getElementById('syncStudents').checked;
            const syncGrades = document.getElementById('syncGrades').checked;

            let syncMessage = `Starting sync with ${course.name}...\n\n`;
            if (syncAssignments) syncMessage += '‚úÖ Syncing assignments\n';
            if (syncStudents) syncMessage += '‚úÖ Syncing student roster\n';
            if (syncGrades) syncMessage += '‚úÖ Syncing grades\n';

            showSuccessMessage(syncMessage);

            // Simulate sync process
            setTimeout(() => {
                showSuccessMessage(`Sync completed successfully! üéâ\n\nVR Class is now connected with ${course.name}`);
            }, 3000);
        }

        function disconnectGoogleClassroom() {
            if (confirm('Are you sure you want to disconnect from Google Classroom?\n\nThis will remove all synced data.')) {
                localStorage.removeItem('googleClassroomAuthorized');
                isGoogleClassroomAuthorized = false;
                googleClassroomCourses = [];
                
                document.getElementById('classroomAuth').style.display = 'block';
                document.getElementById('classroomDashboard').style.display = 'none';
                
                // Reset the authorize button
                const btn = document.getElementById('authorizeBtn');
                btn.innerHTML = 'üîê Authorize Google Classroom Access';
                btn.disabled = false;
                
                loadStats(); // Update stats to reflect disconnection
                showSuccessMessage('Disconnected from Google Classroom successfully! üîå');
            }
        }

        function showSuccessMessage(message) {
            // Create a temporary success message
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: rgba(76, 175, 80, 0.9);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                z-index: 10001;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(10px);
                max-width: 300px;
                animation: slideInRight 0.3s ease;
            `;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(messageDiv);
                }, 300);
            }, 3000);
        }

        // Initialize Google Classroom when the page loads
        window.addEventListener('load', function() {
            setTimeout(initializeGoogleAPI, 1000);
        });

        // Add CSS animations for success messages
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            .classroom-tab.active {
                background: #FFA500 !important;
                color: #000 !important;
            }
        `;
        document.head.appendChild(style);

        // Student-Teacher Portal Connection Functions
        
        function notifyStudentsNewAssignment(assignment) {
            console.log('Notifying students about new assignment:', assignment.title);
            
            // Create real-time notification system
            const notification = {
                id: Date.now(),
                type: 'assignment',
                title: `New Assignment: ${assignment.title}`,
                message: `${assignment.teacherName} has assigned "${assignment.title}" in ${assignment.subject}`,
                data: assignment,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            // Store in global notifications for students
            const notifications = JSON.parse(localStorage.getItem('studentNotifications') || '[]');
            notifications.unshift(notification);
            localStorage.setItem('studentNotifications', JSON.stringify(notifications));
        }

        function notifyStudentsNewQuiz(quiz) {
            console.log('Notifying students about new quiz:', quiz.title);
            
            const notification = {
                id: Date.now(),
                type: 'quiz',
                title: `New Quiz Available: ${quiz.title}`,
                message: `${quiz.teacherName} has created a new quiz "${quiz.title}" in ${quiz.subject}`,
                data: quiz,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            // Store in global notifications for students
            const notifications = JSON.parse(localStorage.getItem('studentNotifications') || '[]');
            notifications.unshift(notification);
            localStorage.setItem('studentNotifications', JSON.stringify(notifications));
        }

        function addStudentNotification(notification) {
            const notifications = JSON.parse(localStorage.getItem('studentNotifications') || '[]');
            notifications.unshift({
                id: Date.now(),
                ...notification,
                read: false
            });
            localStorage.setItem('studentNotifications', JSON.stringify(notifications));
        }

        // Function to view student submissions for assignments
        function viewAssignmentSubmissions(assignmentId) {
            const assignments = JSON.parse(localStorage.getItem('vrClassAssignments') || '[]');
            const assignment = assignments.find(a => a.id === assignmentId);
            
            if (!assignment) {
                alert('Assignment not found!');
                return;
            }
            
            let submissionReport = `üìö Assignment: ${assignment.title}\n\n`;
            submissionReport += `üìä Submissions: ${assignment.submissions.length}\n`;
            submissionReport += `üìÖ Due Date: ${new Date(assignment.dueDate).toLocaleDateString()}\n\n`;
            
            if (assignment.submissions.length === 0) {
                submissionReport += 'No submissions yet.';
            } else {
                submissionReport += 'Student Submissions:\n';
                assignment.submissions.forEach((submission, index) => {
                    submissionReport += `${index + 1}. ${submission.studentName} - ${submission.status}\n`;
                });
            }
            
            alert(submissionReport);
        }

        // Function to view quiz results
        function viewQuizResults(quizId) {
            const quizzes = JSON.parse(localStorage.getItem('vrClassQuizzes') || '[]');
            const quiz = quizzes.find(q => q.id === quizId);
            
            if (!quiz) {
                alert('Quiz not found!');
                return;
            }
            
            let resultReport = `üìù Quiz: ${quiz.title}\n\n`;
            resultReport += `üë• Attempts: ${quiz.attempts.length}\n`;
            resultReport += `‚è∞ Duration: ${quiz.duration} minutes\n\n`;
            
            if (quiz.attempts.length === 0) {
                resultReport += 'No attempts yet.';
            } else {
                const averageScore = quiz.attempts.reduce((sum, attempt) => sum + attempt.score, 0) / quiz.attempts.length;
                resultReport += `üìä Average Score: ${averageScore.toFixed(1)}%\n\n`;
                resultReport += 'Student Results:\n';
                quiz.attempts.forEach((attempt, index) => {
                    resultReport += `${index + 1}. ${attempt.studentName} - ${attempt.score}%\n`;
                });
            }
            
            alert(resultReport);
        }

        // Function to send announcements to students
        function sendAnnouncement() {
            const announcement = prompt('Enter announcement message:');
            if (announcement) {
                const announcementData = {
                    id: Date.now(),
                    type: 'announcement',
                    title: 'New Announcement',
                    message: announcement,
                    teacherName: currentTeacher.name,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                addStudentNotification(announcementData);
                alert('Announcement sent to all students! üì¢');
            }
        }

        // Function to get student progress report
        function generateStudentReport(studentId) {
            const assignments = JSON.parse(localStorage.getItem('vrClassAssignments') || '[]');
            const quizzes = JSON.parse(localStorage.getItem('vrClassQuizzes') || '[]');
            const users = JSON.parse(localStorage.getItem('vrClassUsers') || '[]');
            
            const student = users.find(u => u.id === studentId);
            if (!student) {
                alert('Student not found!');
                return;
            }
            
            // Calculate student performance
            const studentAssignments = assignments.filter(a => 
                a.submissions.some(s => s.studentId === studentId)
            );
            
            const studentQuizzes = quizzes.filter(q => 
                q.attempts.some(a => a.studentId === studentId)
            );
            
            let report = `üë®‚Äçüéì Student Report: ${student.name}\n\n`;
            report += `üìß Email: ${student.email}\n`;
            report += `üéì Grade: ${student.grade}\n\n`;
            report += `üìö Assignments Completed: ${studentAssignments.length}\n`;
            report += `üìù Quizzes Taken: ${studentQuizzes.length}\n\n`;
            
            if (studentQuizzes.length > 0) {
                const avgQuizScore = studentQuizzes.reduce((sum, quiz) => {
                    const attempt = quiz.attempts.find(a => a.studentId === studentId);
                    return sum + (attempt ? attempt.score : 0);
                }, 0) / studentQuizzes.length;
                
                report += `üìä Average Quiz Score: ${avgQuizScore.toFixed(1)}%\n`;
            }
            
            alert(report);
        }

        // Enhanced student list with connection features
        function loadStudentsWithActions() {
            const users = JSON.parse(localStorage.getItem('vrClassUsers') || '[]');
            const students = users.filter(user => user.userType === 'student');
            
            const studentsList = document.getElementById('studentsList');
            studentsList.innerHTML = '';
            
            if (students.length === 0) {
                studentsList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">No students enrolled yet</div>';
                return;
            }
            
            students.forEach(student => {
                const studentDiv = document.createElement('div');
                studentDiv.className = 'student-item';
                studentDiv.style.cssText = 'padding: 15px; border-bottom: 1px solid rgba(255, 165, 0, 0.1); margin-bottom: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 10px;';
                
                studentDiv.innerHTML = `
                    <div class="student-info" style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                        <div class="student-avatar" style="width: 50px; height: 50px; border-radius: 50%; background: #FFA500; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; font-size: 1.2rem;">
                            ${student.name.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <div style="font-weight: bold; color: #FFA500; font-size: 1.1rem;">${student.name}</div>
                            <div style="opacity: 0.7; font-size: 0.9rem; color: #C0C0C0;">${student.email}</div>
                            <div style="opacity: 0.6; font-size: 0.8rem; color: #C0C0C0;">Grade: ${student.grade}</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="startDoubtSession('${student.id}', '${student.name}')" style="padding: 5px 12px; font-size: 0.8rem;">
                            üé• Video Call
                        </button>
                        <button class="btn btn-secondary" onclick="generateStudentReport('${student.id}')" style="padding: 5px 12px; font-size: 0.8rem;">
                            üìä Report
                        </button>
                        <button class="btn btn-secondary" onclick="sendDirectMessage('${student.id}', '${student.name}')" style="padding: 5px 12px; font-size: 0.8rem;">
                            üí¨ Message
                        </button>
                    </div>
                `;
                studentsList.appendChild(studentDiv);
            });
        }

        // Function to send direct message to student
        function sendDirectMessage(studentId, studentName) {
            const message = prompt(`Send message to ${studentName}:`);
            if (message) {
                const messageData = {
                    id: Date.now(),
                    type: 'message',
                    title: `Message from ${currentTeacher.name}`,
                    message: message,
                    from: currentTeacher.name,
                    to: studentName,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                addStudentNotification(messageData);
                alert(`Message sent to ${studentName}! üí¨`);
            }
        }

        // Override the loadStudents function to use the enhanced version
        function loadStudents() {
            loadStudentsWithActions();
        }

        // Add announcement button to quick actions
        function addAnnouncementToQuickActions() {
            const quickActions = document.querySelector('.quick-actions');
            if (quickActions && !document.getElementById('announcementBtn')) {
                const announcementBtn = document.createElement('button');
                announcementBtn.id = 'announcementBtn';
                announcementBtn.className = 'btn btn-secondary';
                announcementBtn.innerHTML = 'üì¢ Send Announcement';
                announcementBtn.onclick = sendAnnouncement;
                quickActions.appendChild(announcementBtn);
            }
        }

        // Initialize connection features when page loads
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                addAnnouncementToQuickActions();
            }, 1000);
        });
    </script>
    
    <!-- Chatbase AI Integration -->
    <script>
        (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="-JS4MRePUHevy05CT-gZR";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
    </script>
</body>
</html>
